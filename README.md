# README

Playground for ELM features.

Except description, how to run and develop in this stack, you can also find here description for files, scripts and tools used in this example playground.

## How to run in Development mode

### Prerequisites

- [node.js](https://nodejs.org/en/) in version `12.18.3` or newer
- [elm](https://guide.elm-lang.org/install/elm.html)

### Install dependencies

Run in terminal:

```bash
npm install
```

### Development mode

Run in terminal:

```bash
npm run dev
```

It will run application on [localhost:3000](http://localhost:3000/).

### Format, test, precommit

To format code, run in terminal:

```bash
npm run format
```

To run tests, run in terminal:

```bash
npm run test
```

Before each commit, run precommit:

```bash
npm run precommit
```

### Production mode

Run in terminal:

```bash
npm run build
```

Serve output on server.

## About application

This application was bootstrapped with [create-elm-app](https://github.com/halfzebra/create-elm-app). SPA contains few pages with integrated public [api](https://jsonplaceholder.typicode.com/). You can see 2 different flows, how we can (I'm not saying, we should develop in both, only we can..) develop in ELM. Pages are implemented as [opaque type](https://ckoster22.medium.com/advanced-types-in-elm-opaque-types-ec5ec3b84ed2), you can see how pages are connected into whole ELM architecture - usage `Html.map wrapMsg` and `Cmd.map wrapMsg`.

Application is inspired by [Richard Feldman's real world SPA](https://github.com/rtfeldman/elm-spa-example).

## Application structure

See described ELM and JS modules - in `src` directory.

### ELM Modules

- `Flags.elm` - [flags](https://guide.elm-lang.org/interop/flags.html) feature, implemented as opaque type
- `Header.elm` - simple navigation for pages in application. Parameter `Header.view function is current route - to be highlighted in navigation
- `Main.elm` - main module. It contains TODO for live-coding. You can see in it, how child modules (pages) are connected in ELM architecture. See that `Main.Model` is custom type with 2 variants - depends on decode flags result
- `Route.elm` - base example how to work with routes in ELM
- `Styles.elm` - base styling functions

- `Page.NotFound.elm` - simple not found page for unknown routes
- `Page.Posts.elm` - page with posts - implemented that we are ignoring model in update functions and we are using just data from msg payload, that can be old - potencial issue with asynchronous operations (cmd)
- `Page.TodoList.elm` - page with todo items - implemeted without ignoring model in update. See that business logic for user - when to show loading indicator and update data (on success response on delete request from API), etc. is same as in `Page.Posts.elm` module. The data model is just designated differently - the way, how the data `Model` is stored, is different. See what can be achieved with data modeling!

### JS modules

- `index.js` - entrypoint for whole application. See how to work with flags in JS layer
- `serviceWorker.js` - generated by `create-elm-app`, see [docs](https://developers.google.com/web/fundamentals/primers/service-workers)

### HTML modules

- `public/index.html` - base html for whole application. See `<div id="root"></div>` - entrypoint for our ELM application - elm is connected to this `div` in JS layer (`src/index.js` module)

## Scripts

You can find scripts in `package.json`. To run one of scripts described below, add `npm run` prefix in terminal.

- `analyse` - run and launch [elm-analyse](https://github.com/stil4m/elm-analyse) process. Go to [localhost:50000](http://localhost:50000/) to see results. Port 50000 is hardcoded in script. This process has hot reload - you can change code and you can see updated results
- `build` - build application in Production mode
- `dev` - run application in Development mode
- `format` - format all ELM files (with [elm-format](https://github.com/avh4/elm-format)) and JS files (with [prettier](https://prettier.io/)). In behind, it uses `format:elm-format` and `format:prettier` scripts
- `format:elm-format` - format only ELM files
- `format:prettier` - format only JS files
- `precommit` - use before each commit to check format code and run tests
- `test` - run tests
- `test:watch` - run tests in watch mode

## Configutation files for tools (tools)

- [elm-analyse](https://github.com/stil4m/elm-analyse) - tool to do static analyse form ELM files. See base configuration for it in `elm-analyse.json` file.
- [prettier](https://prettier.io/) - formatter for JS and HTML files. See `prettierignore` a `.prettierrc.yaml` configuration files.
